import Navbar from "@components/navbar/Navbar";
import Sidebar from "@components/sidebar/Sidebar";
import useClickOutside from "@hooks/useClickOutside";
import { useRef, useState } from "react";
import styled from "styled-components";

const GeneralLayout = ({ children }) => {
  const [isopen, setIsOpen] = useState(false);

  const sideBarRef = useRef();
  const hamRef = useRef();
  const toggleSidebar = () => setIsOpen(false);

  useClickOutside(sideBarRef, hamRef, toggleSidebar, isopen);

  return (
    <GeneralLayoutStyles isopen={isopen}>
      <div className="parent">
        <div className="sidebar" ref={sideBarRef}>
          <div className="sidebar_top _grid_center">
            <svg
              width="201"
              height="41"
              viewBox="0 0 201 41"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M19.4492 23.0703C19.4492 24.763 19.0391 26.2344 18.2188 27.4844C17.3984 28.7344 16.2005 29.6979 14.625 30.375C13.0625 31.0521 11.1615 31.3906 8.92188 31.3906C7.93229 31.3906 6.96224 31.3255 6.01172 31.1953C5.07422 31.0651 4.16927 30.8763 3.29688 30.6289C2.4375 30.3685 1.61719 30.0495 0.835938 29.6719V24.0469C2.1901 24.6458 3.59635 25.1862 5.05469 25.668C6.51302 26.1497 7.95833 26.3906 9.39062 26.3906C10.3802 26.3906 11.1745 26.2604 11.7734 26C12.3854 25.7396 12.8281 25.3815 13.1016 24.9258C13.375 24.4701 13.5117 23.9492 13.5117 23.3633C13.5117 22.6471 13.2708 22.0352 12.7891 21.5273C12.3073 21.0195 11.6432 20.5443 10.7969 20.1016C9.96354 19.6589 9.01953 19.1836 7.96484 18.6758C7.30078 18.3633 6.57812 17.9857 5.79688 17.543C5.01562 17.0872 4.27344 16.5339 3.57031 15.8828C2.86719 15.2318 2.28776 14.444 1.83203 13.5195C1.38932 12.582 1.16797 11.4622 1.16797 10.1602C1.16797 8.45443 1.55859 6.99609 2.33984 5.78516C3.12109 4.57422 4.23438 3.64974 5.67969 3.01172C7.13802 2.36068 8.85677 2.03516 10.8359 2.03516C12.3203 2.03516 13.7331 2.21094 15.0742 2.5625C16.4284 2.90104 17.8411 3.39583 19.3125 4.04688L17.3594 8.75391C16.0443 8.22005 14.8659 7.8099 13.8242 7.52344C12.7826 7.22396 11.7214 7.07422 10.6406 7.07422C9.88542 7.07422 9.24089 7.19792 8.70703 7.44531C8.17318 7.67969 7.76953 8.01823 7.49609 8.46094C7.22266 8.89062 7.08594 9.39193 7.08594 9.96484C7.08594 10.6419 7.28125 11.2148 7.67188 11.6836C8.07552 12.1393 8.67448 12.582 9.46875 13.0117C10.276 13.4414 11.2786 13.9427 12.4766 14.5156C13.9349 15.2057 15.1784 15.9284 16.207 16.6836C17.2487 17.4258 18.0495 18.3047 18.6094 19.3203C19.1693 20.3229 19.4492 21.5729 19.4492 23.0703ZM33.1016 8.71484C36.0312 8.71484 38.2773 9.35286 39.8398 10.6289C41.4023 11.9049 42.1836 13.8451 42.1836 16.4492V31H38.0234L36.8711 28.0312H36.7148C36.0898 28.8125 35.4518 29.4505 34.8008 29.9453C34.1497 30.4401 33.401 30.8047 32.5547 31.0391C31.7083 31.2734 30.6797 31.3906 29.4688 31.3906C28.1797 31.3906 27.0208 31.1432 25.9922 30.6484C24.9766 30.1536 24.1758 29.3984 23.5898 28.3828C23.0039 27.3542 22.7109 26.0521 22.7109 24.4766C22.7109 22.1589 23.5247 20.4531 25.1523 19.3594C26.7799 18.2526 29.2214 17.6406 32.4766 17.5234L36.2656 17.4062V16.4492C36.2656 15.3034 35.9661 14.4635 35.3672 13.9297C34.7682 13.3958 33.9349 13.1289 32.8672 13.1289C31.8125 13.1289 30.7773 13.2786 29.7617 13.5781C28.7461 13.8776 27.7305 14.2552 26.7148 14.7109L24.7422 10.6875C25.901 10.0755 27.1966 9.59375 28.6289 9.24219C30.0742 8.89062 31.5651 8.71484 33.1016 8.71484ZM36.2656 20.8828L33.9609 20.9609C32.0339 21.013 30.6927 21.3581 29.9375 21.9961C29.1953 22.6341 28.8242 23.474 28.8242 24.5156C28.8242 25.4271 29.0911 26.0781 29.625 26.4688C30.1589 26.8464 30.8555 27.0352 31.7148 27.0352C32.9909 27.0352 34.0651 26.6576 34.9375 25.9023C35.8229 25.1471 36.2656 24.0729 36.2656 22.6797V20.8828ZM60.4062 13.6367H55.25V31H49.293V13.6367H46.0117V10.7656L49.293 9.16406V7.5625C49.293 5.70052 49.6055 4.25521 50.2305 3.22656C50.8685 2.1849 51.7604 1.45573 52.9062 1.03906C54.0651 0.609375 55.4323 0.394531 57.0078 0.394531C58.1667 0.394531 59.2214 0.492188 60.1719 0.6875C61.1224 0.869792 61.8971 1.07812 62.4961 1.3125L60.9727 5.6875C60.5169 5.54427 60.0221 5.41406 59.4883 5.29688C58.9544 5.17969 58.3424 5.12109 57.6523 5.12109C56.819 5.12109 56.207 5.375 55.8164 5.88281C55.4388 6.3776 55.25 7.01562 55.25 7.79688V9.16406H60.4062V13.6367ZM72.8477 8.75391C74.8659 8.75391 76.6042 9.14453 78.0625 9.92578C79.5208 10.694 80.6471 11.8138 81.4414 13.2852C82.2357 14.7565 82.6328 16.5534 82.6328 18.6758V21.5664H68.5508C68.6159 23.2461 69.1172 24.5677 70.0547 25.5312C71.0052 26.4818 72.3203 26.957 74 26.957C75.3932 26.957 76.6693 26.8138 77.8281 26.5273C78.987 26.2409 80.1784 25.8112 81.4023 25.2383V29.8477C80.3216 30.3815 79.1888 30.7721 78.0039 31.0195C76.832 31.2669 75.4062 31.3906 73.7266 31.3906C71.5391 31.3906 69.599 30.987 67.9062 30.1797C66.2266 29.3724 64.9049 28.1419 63.9414 26.4883C62.9909 24.8346 62.5156 22.7513 62.5156 20.2383C62.5156 17.6862 62.9453 15.5638 63.8047 13.8711C64.6771 12.1654 65.888 10.8893 67.4375 10.043C68.987 9.18359 70.7904 8.75391 72.8477 8.75391ZM72.8867 12.9922C71.7279 12.9922 70.7643 13.3633 69.9961 14.1055C69.2409 14.8477 68.8047 16.013 68.6875 17.6016H77.0469C77.0339 16.7161 76.8711 15.9284 76.5586 15.2383C76.2591 14.5482 75.8034 14.0013 75.1914 13.5977C74.5924 13.194 73.8242 12.9922 72.8867 12.9922Z"
                fill="#122025"
              />
              <path
                d="M87.9453 2.44531H96.832C100.634 2.44531 103.512 2.97917 105.465 4.04688C107.418 5.11458 108.395 6.98958 108.395 9.67188C108.395 10.7526 108.219 11.7292 107.867 12.6016C107.529 13.474 107.034 14.1901 106.383 14.75C105.732 15.3099 104.938 15.6745 104 15.8438V16.0391C104.951 16.2344 105.81 16.5729 106.578 17.0547C107.346 17.5234 107.958 18.2135 108.414 19.125C108.883 20.0234 109.117 21.2214 109.117 22.7188C109.117 24.4505 108.694 25.9349 107.848 27.1719C107.001 28.4089 105.79 29.3594 104.215 30.0234C102.652 30.6745 100.79 31 98.6289 31H87.9453V2.44531ZM94 13.7539H97.5156C99.2734 13.7539 100.491 13.4805 101.168 12.9336C101.845 12.3737 102.184 11.5534 102.184 10.4727C102.184 9.37891 101.78 8.59766 100.973 8.12891C100.178 7.64714 98.9154 7.40625 97.1836 7.40625H94V13.7539ZM94 18.5586V26H97.9453C99.7682 26 101.038 25.6484 101.754 24.9453C102.47 24.2422 102.828 23.2982 102.828 22.1133C102.828 21.4102 102.672 20.7917 102.359 20.2578C102.047 19.724 101.52 19.3073 100.777 19.0078C100.048 18.7083 99.0391 18.5586 97.75 18.5586H94ZM134.391 9.16406V31H129.82L129.02 28.207H128.707C128.238 28.9492 127.652 29.5547 126.949 30.0234C126.246 30.4922 125.471 30.8372 124.625 31.0586C123.779 31.2799 122.9 31.3906 121.988 31.3906C120.426 31.3906 119.065 31.1172 117.906 30.5703C116.747 30.0104 115.842 29.1445 115.191 27.9727C114.553 26.8008 114.234 25.2773 114.234 23.4023V9.16406H120.191V21.918C120.191 23.4805 120.471 24.6589 121.031 25.4531C121.591 26.2474 122.483 26.6445 123.707 26.6445C124.918 26.6445 125.868 26.3711 126.559 25.8242C127.249 25.2643 127.73 24.4505 128.004 23.3828C128.29 22.3021 128.434 20.987 128.434 19.4375V9.16406H134.391ZM166.285 8.75391C168.759 8.75391 170.628 9.39193 171.891 10.668C173.167 11.931 173.805 13.9622 173.805 16.7617V31H167.828V18.2461C167.828 16.6836 167.561 15.5052 167.027 14.7109C166.493 13.9167 165.667 13.5195 164.547 13.5195C162.971 13.5195 161.852 14.0859 161.188 15.2188C160.523 16.3385 160.191 17.9466 160.191 20.043V31H154.234V18.2461C154.234 17.2044 154.117 16.332 153.883 15.6289C153.648 14.9258 153.29 14.3984 152.809 14.0469C152.327 13.6953 151.708 13.5195 150.953 13.5195C149.846 13.5195 148.974 13.7995 148.336 14.3594C147.711 14.9062 147.262 15.7201 146.988 16.8008C146.728 17.8685 146.598 19.1771 146.598 20.7266V31H140.641V9.16406H145.191L145.992 11.957H146.324C146.767 11.2018 147.32 10.5898 147.984 10.1211C148.661 9.65234 149.404 9.30729 150.211 9.08594C151.018 8.86458 151.839 8.75391 152.672 8.75391C154.273 8.75391 155.628 9.01432 156.734 9.53516C157.854 10.056 158.714 10.8633 159.312 11.957H159.84C160.491 10.8372 161.409 10.0234 162.594 9.51562C163.792 9.00781 165.022 8.75391 166.285 8.75391ZM192.086 8.75391C194.547 8.75391 196.533 9.71094 198.043 11.625C199.566 13.5391 200.328 16.3451 200.328 20.043C200.328 22.5169 199.97 24.6003 199.254 26.293C198.538 27.9727 197.548 29.2422 196.285 30.1016C195.022 30.9609 193.57 31.3906 191.93 31.3906C190.875 31.3906 189.97 31.2604 189.215 31C188.46 30.7266 187.815 30.3815 187.281 29.9648C186.747 29.5352 186.285 29.0794 185.895 28.5977H185.582C185.686 29.1185 185.764 29.6523 185.816 30.1992C185.868 30.7461 185.895 31.2799 185.895 31.8008V40.6094H179.938V9.16406H184.781L185.621 11.9961H185.895C186.285 11.4102 186.76 10.8698 187.32 10.375C187.88 9.88021 188.551 9.48958 189.332 9.20312C190.126 8.90365 191.044 8.75391 192.086 8.75391ZM190.172 13.5195C189.13 13.5195 188.303 13.7344 187.691 14.1641C187.079 14.5938 186.63 15.2383 186.344 16.0977C186.07 16.957 185.921 18.0443 185.895 19.3594V20.0039C185.895 21.4102 186.025 22.6016 186.285 23.5781C186.559 24.5547 187.008 25.2969 187.633 25.8047C188.271 26.3125 189.143 26.5664 190.25 26.5664C191.161 26.5664 191.91 26.3125 192.496 25.8047C193.082 25.2969 193.518 24.5547 193.805 23.5781C194.104 22.5885 194.254 21.3841 194.254 19.9648C194.254 17.8294 193.922 16.2214 193.258 15.1406C192.594 14.0599 191.565 13.5195 190.172 13.5195Z"
                fill="#06AAE4"
              />
            </svg>
          </div>
          <div className="sidebar_main _auto_scroll_y">
            <Sidebar />
          </div>
        </div>
        <div className="main">
          <div className="navbar">
            <Navbar isopen={isopen} setIsOpen={setIsOpen} hamRef={hamRef} />
          </div>
          <div className="main_content _auto_scroll_y">{children}</div>
        </div>
      </div>
    </GeneralLayoutStyles>
  );
};

export default GeneralLayout;

const GeneralLayoutStyles = styled.div`
  &&& {
    --nav_height: 105px;
    --main_content_pad: 35px 50px 30px;

    position: fixed;
    inset: 0;
    background: #ffffff;
    padding: 0px;

    * {
      padding: 0;
      /* margin: 0; */
    }

    .parent {
      /* background: #00000018; */
      background: #ffffff;
      /*  */
      max-width: 100%;
      min-width: 100%;
      max-height: 100%;
      min-height: 100%;

      display: flex;
      gap: 5px;

      .sidebar {
        width: min(20%, 304px);
        min-width: 260px;
        max-width: 304px;
        display: flex;
        flex-direction: column;
        gap: 20px;
        border: 1px solid #e4e1e8;
        background: #fafafa;

        .sidebar_top {
          min-height: var(--nav_height);
          max-height: var(--nav_height);
        }
        .sidebar_main {
          /* background: #fafafa; */
        }
      }

      .main {
        display: flex;
        flex-direction: column;
        flex: 1;

        > * {
          max-width: 100%;
          min-width: 100%;
        }

        .navbar {
          min-height: var(--nav_height);
          max-height: var(--nav_height);

          max-width: 100%;
          min-width: 100%;
        }

        .main_content {
          flex: 1;
          padding: var(--main_content_pad);
          background: #fbfbfb;
        }
      }

      @media screen and (max-width: 900px) {
        --main_content_pad: 30px;

        .sidebar {
          transition: all 0.3s ease-in;

          position: fixed;
          top: 0;
          bottom: 0;
          left: 0;
          transform: ${({ isopen }) =>
            !isopen ? "translateX(-105%)" : "translateX(0%)"};
          max-width: 260px;
          min-width: 250px;

          z-index: 10;
        }
      }
    }
  }
`;
